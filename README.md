# Potentiostat Shield for Arduino Uno
The is project is a piece of software to run a Potentiostat shield on a Arduino Uno.


## Background
A potentiostat/galvanostat is a device used to control electrochemical experiments. It can control either voltage or current between 2 or 3 electrod. For more infomration see the following links. 

* [Wikipedia Potentiostat](https://en.wikipedia.org/wiki/Potentiostat)
* [Wikipedia Galvanostat](https://en.wikipedia.org/wiki/Galvanostat)

## The Potentiostat Shield
In the software, the following signals from the arduino is used by the potentiostat shield in order to make a function potentiostat:

* D5 - Cell Switch
* D6,D7 - Current Range
* D10,D11,D12,D13 - SPI
* A0 - Virtual Ground (50% of Vcc)
* A1 - Voltage of the reference electode
* A2 - Voltage of the Current converter(IE)

### How it works

A potentiostat works with signed voltages and currents. As the arduino uno can only measure and support 0-5V, a virtual ground must be introduced which is at 2.5V(50% of Vcc). 
The current-to-voltage converter(IE) is connected to the working electrode. It measured the current and keeps the working electrode at the potential of the virtual voltage. The potential of the working electrode(E) is the voltage different between reference electrode and the working electrode. In order to obtain this value, the arduino must first measure both virtual ground and the voltage of the reference electrode, then calculate the difference between the values. Similarliy,  the current signal is to be measured. 

 




## The Potentiostat Shield - DIY solder
This potentisotat shield was developed in order to used as few and easy to solder(DIP package) components as possible in order to turn an arduino UNO into a potentiostat/galvanostat. 
The potentiostat has different has a cell switch and 4 different current ranges. The control signal is generated by a SPI DAC, while the voltages are measured using ADC of the arduion.

### Potentiostat Shield Schematics

The following image shows the schematics of potentiostat shield.

![Potentiostat Shield Schematic](/assets/images/UNO_Pot_Shield_1_1_schematic.png)

Higher resolution image be seen in the [PDF](Schematic%20Design_%20UNO_%20Pot%20Shield_1_1.pdf)

 

### Potentiostat Shield PCB

The following image shows the potentiostat shield PCB.

![Potentiostat Shield PCB](/assets/images/UNO_Pot_Shield_1_1_s.png)


[Potentiostat Shield PCB with higher resolution](/assets/images/UNO_Pot_Shield_1_1.png)


### Compoents (BOM)
 * DAC MCP4921 1x
 * MUX DG409 1x
 * OPA-2ch MCP607 1x
 * Screw Terminal-3x    
 * Resistors
   * 100 Ohm 1x
   * 1 kOhm 1x
   * 10 kOhm 6x
   * 100 kOhm 1x
   * 10 MOhm 1x
 * Capacitors
   * 10 nF 1x
   * 100 nF 3x

#Communcation with 

The supplied software controls the shield, but also permits communication to a computer via serial commands. The BAUD rate is set to 115200.

##Commands

The following table showes the commands that can be used to control the potentiostat. Values within a "[x]" are optional. All commands sent generate a responds from the potentiostat. All command arguments are integers should be seperated with a normal space. All commands and replies end with a newline "\n".

| Command | Argument    | Info    |
| :-----: | :---: | :---: |
| /? |   | Prints the list of commands   |
| CELL | [0 or 1]   |  Sets or reads the cell switch.  |
| CMODE | [0,1,2]   | Change the control mode:  "Cell", "E", "I"   |
| IE | [n]   | Sets the current mode. Values corresponds to the exponent of the current.  |
| SET | [mV]   | Sets the setvalue of the control system in mV. In potentiostatic mode(mode 0 and 1), the values corresponds the voltage between RE and WE in mV. In galvanostatic mode, the value correspond to the values of the IE converter in mV.    |
| ABORT |    | Aborts any running technique   |
| HALT |    | Halts or restarts any running technique  |
| RAMP | V0 V1 V2 R S  | Generates linear sweeps startings at V0, and then to V1 and V2. R is the scan rate in mV/s and S is number of sweeps.   |
| STEP | V0 t0 V1 t1 [V2 t2]  | Steps from V0 to V1 and then V2, if added. Values are in mV and should be an integer. t0,t1 and t2 are the duration in ms.   |

##Data plotting

The potentiostat is plotting repetitively the values of the time, E and i to the serial port. In order to filter out the data in contast to an echoed commands, each data line starts with a "\t", and all values are also separated by tab("\t"). A typical line of data is then as follows:

"\t" [TIME in ms] "\t" [E in mV] "\t" [i in A] "\n"


